@import helper._
@import window._
@import service.ProductionService.ProductionInfoData
@(form: Form[ProductionInfoData], uploadImageCall: Call)(implicit request: RequestHeader, messages: Messages)

@windowBase(Messages("manage.production.create"), "main-window", "window-new-production"){
<ul>
    <li class="window-menu-content">@Html(Messages("window.menu.file"))</li>
    <li class="window-menu-content">@Html(Messages("window.menu.edit"))</li>
    <li class="window-menu-content">@Html(Messages("window.menu.search"))</li>
    <li class="window-menu-content">@Html(Messages("window.menu.help"))</li>
</ul>
} {
    @helper.form(action = routes.Productions.create(), Symbol("enctype") -> "multipart/form-data", Symbol("id") -> "manageProduction-form") {
        @CSRF.formField
        @helper.inputText(form("title"))
        <input type="file" name="thumbnail_image">
        <textarea class="new-production-content" name="content"></textarea>
        <input type="submit">
    }
    <script>
        $(document).ready(function() {
            $('.new-production-content').trumbowyg({
                btnsDef: {
                    image: {
                        dropdown: ['insertImage', 'upload'],
                        ico: 'insertImage'
                    }
                },
                btns: [
                    ['viewHTML'],
                    ['formatting'],
                    ['strong', 'em', 'del'],
                    ['superscript', 'subscript'],
                    ['link'],
                    ['image'],
                    ['justifyLeft', 'justifyCenter', 'justifyRight', 'justifyFull'],
                    ['unorderedList', 'orderedList'],
                    ['horizontalRule'],
                    ['removeformat'],
                    ['fullscreen']
                ],
                imageWidthModalEdit: true,
                plugins: {
                    upload: {
                        serverPath: "@helper.CSRF(routes.Images.upload()).url",
                        fileFieldName: 'image',
                        success: function (data, trumbowyg, $modal, values) {
                            var editor = $('.new-production-content');
                            editor.trumbowyg('html', '<img src="' + data.file + '" alt="' + values.alt + '" width="' + values.width + '">');
                            editor.trumbowyg('closeModal');
                        },
                        error: function() {
                            console.log("test");
                        },
                        imageWidthModalEdit: true
                    }
                }
            });
        });
    </script>
}